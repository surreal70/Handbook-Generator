<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0190 - Log Management und Audit</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="template-number">0190</div>
            <h1>Log Management und Audit</h1>
        </header>
        
        <nav class="page-nav">
<a href="0180_Patch_und_Update_Management.html" class="nav-prev">← Zurück</a>
<a href="index.html" class="nav-toc">Inhaltsverzeichnis</a>
<a href="0200_Kapazitaets_und_Performance_Management.html" class="nav-next">Weiter →</a>
        </nav>
        
        <main>
<h1 id="log-management-und-audit">Log Management und Audit</h1>
<h2 id="zweck-und-geltungsbereich">Zweck und Geltungsbereich</h2>
<p>Dieses Dokument beschreibt die Log-Management- und Audit-Prozesse für AdminSend GmbH. Es definiert Log-Sammlung, -Aggregation, -Retention, Audit-Trail-Anforderungen und SIEM-Integration zur Sicherstellung von Nachvollziehbarkeit, Compliance und Security-Monitoring.</p>
<p><strong>Geltungsbereich:</strong> Alle IT-Systeme, Netzwerke, Applikationen und Security-Komponenten von AdminSend GmbH</p>
<p><strong>Verantwortlich:</strong> Thomas Weber (thomas.weber@adminsend.de)</p>
<h2 id="log-management-grundlagen">Log-Management-Grundlagen</h2>
<h3 id="ziele">Ziele</h3>
<p><strong>Primäre Ziele:</strong>
- <strong>Security-Monitoring:</strong> Erkennung von Sicherheitsvorfällen
- <strong>Compliance:</strong> Erfüllung regulatorischer Anforderungen
- <strong>Troubleshooting:</strong> Fehleranalyse und Problemlösung
- <strong>Forensik:</strong> Nachvollziehbarkeit von Ereignissen
- <strong>Audit:</strong> Nachweis von Kontrollen und Prozessen
- <strong>Performance-Analyse:</strong> System- und Applikations-Performance</p>
<h3 id="log-typen">Log-Typen</h3>
<h4 id="system-logs">System-Logs</h4>
<p><strong>Beschreibung:</strong> Betriebssystem-Ereignisse</p>
<p><strong>Beispiele:</strong>
- Windows Event Logs (Security, System, Application)
- Linux Syslog (/var/log/messages, /var/log/auth.log)
- Boot-Logs, Kernel-Logs</p>
<p><strong>Wichtige Events:</strong>
- System-Start/-Stop
- Service-Start/-Stop
- Fehler und Warnungen
- Hardware-Events</p>
<h4 id="security-logs">Security-Logs</h4>
<p><strong>Beschreibung:</strong> Sicherheitsrelevante Ereignisse</p>
<p><strong>Beispiele:</strong>
- Authentifizierungs-Events (Login, Logout, Failed Login)
- Autorisierungs-Events (Zugriffsverweigerung)
- Privilegien-Änderungen
- Security-Policy-Änderungen
- Firewall-Logs
- IDS/IPS-Alerts</p>
<p><strong>Wichtige Events:</strong>
- Failed Login Attempts
- Privilege Escalation
- Account-Änderungen
- Security-Policy-Änderungen</p>
<h4 id="application-logs">Application-Logs</h4>
<p><strong>Beschreibung:</strong> Applikations-spezifische Ereignisse</p>
<p><strong>Beispiele:</strong>
- Web-Server-Logs (Apache, Nginx, IIS)
- Datenbank-Logs (MySQL, PostgreSQL, SQL Server)
- Applikations-Logs (Custom-Apps)
- Middleware-Logs (Tomcat, JBoss)</p>
<p><strong>Wichtige Events:</strong>
- Applikations-Fehler
- Transaktions-Logs
- Performance-Metriken
- User-Aktivitäten</p>
<h4 id="network-logs">Network-Logs</h4>
<p><strong>Beschreibung:</strong> Netzwerk-Ereignisse</p>
<p><strong>Beispiele:</strong>
- Firewall-Logs
- Router/Switch-Logs
- VPN-Logs
- DNS-Logs
- DHCP-Logs
- Proxy-Logs</p>
<p><strong>Wichtige Events:</strong>
- Verbindungs-Versuche (erlaubt/blockiert)
- Netzwerk-Änderungen
- Bandwidth-Nutzung
- Anomalien</p>
<h4 id="audit-logs">Audit-Logs</h4>
<p><strong>Beschreibung:</strong> Compliance- und Audit-relevante Ereignisse</p>
<p><strong>Beispiele:</strong>
- Daten-Zugriffe
- Konfigurations-Änderungen
- Administrative Aktivitäten
- Privilegierte Zugriffe</p>
<p><strong>Wichtige Events:</strong>
- Wer hat was wann gemacht?
- Änderungen an kritischen Systemen
- Zugriff auf sensible Daten</p>
<h3 id="log-levels">Log-Levels</h3>
<table>
<thead>
<tr>
<th>Level</th>
<th>Beschreibung</th>
<th>Verwendung</th>
<th>Beispiel</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>EMERGENCY</strong></td>
<td>System unbrauchbar</td>
<td>Kritische Systemfehler</td>
<td>Kernel Panic</td>
</tr>
<tr>
<td><strong>ALERT</strong></td>
<td>Sofortige Aktion erforderlich</td>
<td>Kritische Fehler</td>
<td>Datenbank nicht erreichbar</td>
</tr>
<tr>
<td><strong>CRITICAL</strong></td>
<td>Kritische Bedingungen</td>
<td>Schwere Fehler</td>
<td>Disk voll</td>
</tr>
<tr>
<td><strong>ERROR</strong></td>
<td>Fehler-Bedingungen</td>
<td>Fehler</td>
<td>Applikations-Fehler</td>
</tr>
<tr>
<td><strong>WARNING</strong></td>
<td>Warnungs-Bedingungen</td>
<td>Warnungen</td>
<td>Disk 80% voll</td>
</tr>
<tr>
<td><strong>NOTICE</strong></td>
<td>Normale aber signifikante Bedingung</td>
<td>Wichtige Events</td>
<td>Service gestartet</td>
</tr>
<tr>
<td><strong>INFO</strong></td>
<td>Informations-Meldungen</td>
<td>Normale Events</td>
<td>User-Login</td>
</tr>
<tr>
<td><strong>DEBUG</strong></td>
<td>Debug-Meldungen</td>
<td>Entwicklung</td>
<td>Funktions-Aufrufe</td>
</tr>
</tbody>
</table>
<h2 id="log-sammlung-und-aggregation">Log-Sammlung und -Aggregation</h2>
<h3 id="log-architektur">Log-Architektur</h3>
<div class="codehilite"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                    </span><span class="n">Log</span><span class="o">-</span><span class="n">Quellen</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Servers</span><span class="p">,</span><span class="w"> </span><span class="n">Network</span><span class="p">,</span><span class="w"> </span><span class="n">Applications</span><span class="p">,</span><span class="w"> </span><span class="n">Security</span><span class="o">-</span><span class="n">Devices</span><span class="w">       </span><span class="err">│</span>
<span class="err">└────────────────────┬────────────────────────────────────┘</span>
<span class="w">                     </span><span class="err">│</span>
<span class="w">                     </span><span class="err">│</span><span class="w"> </span><span class="n">Syslog</span><span class="p">,</span><span class="w"> </span><span class="n">Agents</span><span class="p">,</span><span class="w"> </span><span class="n">APIs</span>
<span class="w">                     </span><span class="err">│</span>
<span class="err">┌────────────────────▼────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">              </span><span class="n">Log</span><span class="o">-</span><span class="n">Collectors</span><span class="o">/</span><span class="n">Forwarders</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Rsyslog</span><span class="p">,</span><span class="w"> </span><span class="n">Fluentd</span><span class="p">,</span><span class="w"> </span><span class="n">Logstash</span><span class="p">,</span><span class="w"> </span><span class="n">Splunk</span><span class="w"> </span><span class="n">Forwarders</span><span class="w">         </span><span class="err">│</span>
<span class="err">└────────────────────┬────────────────────────────────────┘</span>
<span class="w">                     </span><span class="err">│</span>
<span class="w">                     </span><span class="err">│</span><span class="w"> </span><span class="n">Parsing</span><span class="p">,</span><span class="w"> </span><span class="n">Filtering</span><span class="p">,</span><span class="w"> </span><span class="n">Enrichment</span>
<span class="w">                     </span><span class="err">│</span>
<span class="err">┌────────────────────▼────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">              </span><span class="n">Log</span><span class="o">-</span><span class="n">Aggregation</span><span class="o">-</span><span class="n">Platform</span><span class="w">                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">SIEM</span><span class="p">,</span><span class="w"> </span><span class="n">ELK</span><span class="w"> </span><span class="n">Stack</span><span class="p">,</span><span class="w"> </span><span class="n">Splunk</span><span class="p">,</span><span class="w"> </span><span class="n">Graylog</span><span class="w">                       </span><span class="err">│</span>
<span class="err">└────────────────────┬────────────────────────────────────┘</span>
<span class="w">                     </span><span class="err">│</span>
<span class="w">         </span><span class="err">┌───────────┴───────────┐</span>
<span class="w">         </span><span class="err">│</span><span class="w">                       </span><span class="err">│</span>
<span class="err">┌────────▼────────┐</span><span class="w">    </span><span class="err">┌────────▼────────────────────────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">Hot</span><span class="w"> </span><span class="n">Storage</span><span class="w">     </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Cold</span><span class="w"> </span><span class="n">Storage</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Archive</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="p">(</span><span class="n">Fast</span><span class="w"> </span><span class="n">Access</span><span class="p">)</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="p">(</span><span class="n">Long</span><span class="o">-</span><span class="n">term</span><span class="w"> </span><span class="n">Retention</span><span class="p">)</span><span class="w">           </span><span class="err">│</span>
<span class="err">└─────────────────┘</span><span class="w">    </span><span class="err">└─────────────────────────────────┘</span>
</code></pre></div>

<h3 id="log-sammlung-methoden">Log-Sammlung-Methoden</h3>
<h4 id="syslog">Syslog</h4>
<p><strong>Protokoll:</strong> RFC 5424 (Syslog Protocol)<br />
<strong>Transport:</strong> UDP 514 (Standard), TCP 514 (Reliable), TLS 6514 (Secure)</p>
<p><strong>Vorteile:</strong>
- Standard-Protokoll
- Weit verbreitet
- Einfache Konfiguration</p>
<p><strong>Nachteile:</strong>
- UDP nicht zuverlässig
- Begrenzte Struktur
- Keine Authentifizierung (ohne TLS)</p>
<p><strong>Verwendung:</strong> Linux/Unix-Systeme, Netzwerk-Geräte</p>
<h4 id="agent-basiert">Agent-basiert</h4>
<p><strong>Agents:</strong>
- Splunk Universal Forwarder
- Elastic Beats (Filebeat, Metricbeat)
- Fluentd
- NXLog</p>
<p><strong>Vorteile:</strong>
- Zuverlässige Übertragung
- Lokale Pufferung
- Parsing und Filtering
- Verschlüsselte Übertragung</p>
<p><strong>Nachteile:</strong>
- Agent-Installation erforderlich
- Agent-Management
- Ressourcen-Verbrauch</p>
<p><strong>Verwendung:</strong> Server, Workstations</p>
<h4 id="api-basiert">API-basiert</h4>
<p><strong>Methoden:</strong>
- REST APIs
- Cloud-Provider-APIs (AWS CloudWatch, Azure Monitor)
- Webhook-Integration</p>
<p><strong>Vorteile:</strong>
- Strukturierte Daten
- Echtzeit-Integration
- Keine Agent-Installation</p>
<p><strong>Nachteile:</strong>
- API-Limits
- Netzwerk-Abhängigkeit
- Komplexere Konfiguration</p>
<p><strong>Verwendung:</strong> Cloud-Services, SaaS-Applikationen</p>
<h4 id="windows-event-forwarding-wef">Windows Event Forwarding (WEF)</h4>
<p><strong>Methode:</strong> Windows-native Event-Forwarding</p>
<p><strong>Vorteile:</strong>
- Keine zusätzlichen Agents
- Zentrale Konfiguration via GPO
- Zuverlässig</p>
<p><strong>Nachteile:</strong>
- Nur Windows
- Begrenzte Parsing-Optionen</p>
<p><strong>Verwendung:</strong> Windows-Umgebungen</p>
<h3 id="log-aggregation-platform">Log-Aggregation-Platform</h3>
<p><strong>SIEM-System:</strong> {{ meta.siem_system }}<br />
<strong>Version:</strong> {{ meta.siem_version }}<br />
<strong>Management-URL:</strong> {{ meta.siem_url }}</p>
<p><strong>Komponenten:</strong>
- <strong>Log-Collectors:</strong> {{ meta.log_collectors }}
- <strong>Indexer:</strong> {{ meta.log_indexers }}
- <strong>Search-Heads:</strong> {{ meta.log_search_heads }}
- <strong>Storage:</strong> {{ meta.log_storage }}</p>
<p><strong>Kapazität:</strong>
- <strong>Ingestion-Rate:</strong> {{ meta.log_ingestion_rate }} GB/Tag
- <strong>Storage-Kapazität:</strong> {{ meta.log_storage_capacity }} TB
- <strong>Retention (Hot):</strong> {{ meta.log_retention_hot }} Tage
- <strong>Retention (Cold):</strong> {{ meta.log_retention_cold }} Tage</p>
<h3 id="log-quellen-konfiguration">Log-Quellen-Konfiguration</h3>
<h4 id="linux-server">Linux-Server</h4>
<p><strong>Rsyslog-Konfiguration:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># /etc/rsyslog.d/50-remote.conf</span>

<span class="c1"># Alle Logs an zentralen Syslog-Server senden</span>
*.*<span class="w"> </span>@@syslog.<span class="o">{{</span><span class="w"> </span>meta.organization.domain<span class="w"> </span><span class="o">}}</span>:514

<span class="c1"># Nur Security-Logs senden</span>
authpriv.*<span class="w"> </span>@@syslog.<span class="o">{{</span><span class="w"> </span>meta.organization.domain<span class="w"> </span><span class="o">}}</span>:514

<span class="c1"># TLS-verschlüsselt</span>
<span class="nv">$DefaultNetstreamDriver</span><span class="w"> </span>gtls
<span class="nv">$ActionSendStreamDriverMode</span><span class="w"> </span><span class="m">1</span>
<span class="nv">$ActionSendStreamDriverAuthMode</span><span class="w"> </span>x509/name
*.*<span class="w"> </span>@@syslog.<span class="o">{{</span><span class="w"> </span>meta.organization.domain<span class="w"> </span><span class="o">}}</span>:6514
</code></pre></div>

<h4 id="windows-server">Windows-Server</h4>
<p><strong>Event-Forwarding-Konfiguration:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c"># Event-Forwarding aktivieren</span>
<span class="n">wecutil</span> <span class="n">qc</span>

<span class="c"># Subscription erstellen</span>
<span class="n">wecutil</span> <span class="n">cs</span> <span class="n">subscription</span><span class="p">.</span><span class="n">xml</span>

<span class="c"># Subscription-XML</span>
<span class="p">&lt;</span><span class="n">Subscription</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="n">SubscriptionId</span><span class="p">&gt;</span><span class="n">Security-Events</span><span class="p">&lt;/</span><span class="n">SubscriptionId</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="n">DestinationUrl</span><span class="p">&gt;</span><span class="n">http</span><span class="p">://</span><span class="n">wec-server</span><span class="p">.{{</span> <span class="n">meta</span><span class="p">.</span><span class="n">organization</span><span class="p">.</span><span class="n">domain</span> <span class="p">}}:</span><span class="n">5985</span><span class="p">/</span><span class="n">wsman</span><span class="p">&lt;/</span><span class="n">DestinationUrl</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="n">Query</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">QueryList</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="n">Query</span> <span class="n">Id</span><span class="p">=</span><span class="s2">&quot;0&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nb">Select </span><span class="n">Path</span><span class="p">=</span><span class="s2">&quot;Security&quot;</span><span class="p">&gt;*[</span><span class="n">System</span><span class="p">[(</span><span class="n">EventID</span><span class="p">=</span><span class="n">4624</span> <span class="n">or</span> <span class="n">EventID</span><span class="p">=</span><span class="n">4625</span><span class="p">)]]&lt;/</span><span class="n">Select</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="n">Query</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="n">QueryList</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="n">Query</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="n">Subscription</span><span class="p">&gt;</span>
</code></pre></div>

<h4 id="firewall">Firewall</h4>
<p><strong>Syslog-Konfiguration:</strong>
- Syslog-Server: {{ netbox.syslog.server }}
- Facility: Local6
- Severity: Informational und höher
- Format: RFC 5424</p>
<p><strong>Geloggte Events:</strong>
- Alle erlaubten/blockierten Verbindungen
- Policy-Änderungen
- VPN-Verbindungen
- Admin-Zugriffe</p>
<h4 id="web-server-apache">Web-Server (Apache)</h4>
<p><strong>Log-Konfiguration:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c"># /etc/apache2/sites-available/default-ssl.conf</span>

<span class="c"># Access-Log</span>
<span class="nb">CustomLog</span><span class="w"> </span><span class="sx">/var/log/apache2/access.log</span><span class="w"> </span>combined

<span class="c"># Error-Log</span>
<span class="nb">ErrorLog</span><span class="w"> </span><span class="sx">/var/log/apache2/error.log</span>
<span class="nb">LogLevel</span><span class="w"> </span><span class="k">warn</span>

<span class="c"># Forwarding an Syslog</span>
<span class="nb">CustomLog</span><span class="w"> </span><span class="s2">&quot;|/usr/bin/logger -t apache -p local6.info&quot;</span><span class="w"> </span>combined
</code></pre></div>

<h4 id="datenbank-mysql">Datenbank (MySQL)</h4>
<p><strong>Log-Konfiguration:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># /etc/mysql/my.cnf</span>

<span class="k">[mysqld]</span>
<span class="c1"># General Query Log (nur für Debugging)</span>
<span class="na">general_log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0</span>
<span class="na">general_log_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/log/mysql/query.log</span>

<span class="c1"># Error Log</span>
<span class="na">log_error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/log/mysql/error.log</span>

<span class="c1"># Slow Query Log</span>
<span class="na">slow_query_log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">slow_query_log_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/log/mysql/slow.log</span>
<span class="na">long_query_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2</span>

<span class="c1"># Audit Plugin (für Compliance)</span>
<span class="na">plugin-load</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">audit_log.so</span>
<span class="na">audit_log_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/log/mysql/audit.log</span>
<span class="na">audit_log_format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">JSON</span>
</code></pre></div>

<h2 id="log-retention-und-archivierung">Log-Retention und -Archivierung</h2>
<h3 id="retention-policies">Retention-Policies</h3>
<h4 id="retention-nach-log-typ">Retention nach Log-Typ</h4>
<table>
<thead>
<tr>
<th>Log-Typ</th>
<th>Hot Storage</th>
<th>Cold Storage</th>
<th>Gesamt</th>
<th>Begründung</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Security-Logs</strong></td>
<td>90 Tage</td>
<td>7 Jahre</td>
<td>7 Jahre</td>
<td>Compliance, Forensik</td>
</tr>
<tr>
<td><strong>Audit-Logs</strong></td>
<td>90 Tage</td>
<td>7 Jahre</td>
<td>7 Jahre</td>
<td>Compliance, Regulierung</td>
</tr>
<tr>
<td><strong>System-Logs</strong></td>
<td>30 Tage</td>
<td>1 Jahr</td>
<td>1 Jahr</td>
<td>Troubleshooting</td>
</tr>
<tr>
<td><strong>Application-Logs</strong></td>
<td>30 Tage</td>
<td>1 Jahr</td>
<td>1 Jahr</td>
<td>Troubleshooting</td>
</tr>
<tr>
<td><strong>Network-Logs</strong></td>
<td>30 Tage</td>
<td>1 Jahr</td>
<td>1 Jahr</td>
<td>Security, Troubleshooting</td>
</tr>
<tr>
<td><strong>Web-Access-Logs</strong></td>
<td>30 Tage</td>
<td>6 Monate</td>
<td>6 Monate</td>
<td>Analytics, Security</td>
</tr>
<tr>
<td><strong>Debug-Logs</strong></td>
<td>7 Tage</td>
<td>-</td>
<td>7 Tage</td>
<td>Entwicklung</td>
</tr>
</tbody>
</table>
<h4 id="retention-nach-compliance">Retention nach Compliance</h4>
<p><strong>DSGVO:</strong>
- Personenbezogene Daten: Nur so lange wie erforderlich
- Zugriffs-Logs: 6 Monate (empfohlen)
- Security-Logs: 1-2 Jahre</p>
<p><strong>ISO 27001:</strong>
- Security-Logs: Mindestens 1 Jahr
- Audit-Logs: Mindestens 1 Jahr</p>
<p><strong>Branchenspezifisch:</strong>
- Finanzsektor: 7-10 Jahre
- Gesundheitswesen: 10 Jahre
- Telekommunikation: 6 Monate (Vorratsdatenspeicherung)</p>
<h3 id="storage-tiers">Storage-Tiers</h3>
<h4 id="hot-storage-schneller-zugriff">Hot Storage (Schneller Zugriff)</h4>
<p><strong>Technologie:</strong> SSD, NVMe<br />
<strong>Retention:</strong> 30-90 Tage<br />
<strong>Zugriff:</strong> Echtzeit-Suche, Dashboards<br />
<strong>Kosten:</strong> Hoch</p>
<p><strong>Verwendung:</strong>
- Aktive Monitoring
- Security-Analysen
- Troubleshooting</p>
<h4 id="warm-storage-mittlerer-zugriff">Warm Storage (Mittlerer Zugriff)</h4>
<p><strong>Technologie:</strong> HDD, Object Storage<br />
<strong>Retention:</strong> 3-12 Monate<br />
<strong>Zugriff:</strong> Suche (langsamer)<br />
<strong>Kosten:</strong> Mittel</p>
<p><strong>Verwendung:</strong>
- Historische Analysen
- Compliance-Audits
- Forensik</p>
<h4 id="cold-storage-archiv">Cold Storage (Archiv)</h4>
<p><strong>Technologie:</strong> Tape, Cloud Glacier, Object Storage<br />
<strong>Retention:</strong> 1-7 Jahre<br />
<strong>Zugriff:</strong> Restore erforderlich (Stunden bis Tage)<br />
<strong>Kosten:</strong> Niedrig</p>
<p><strong>Verwendung:</strong>
- Langzeit-Archivierung
- Compliance-Anforderungen
- Rechtliche Aufbewahrung</p>
<h3 id="archivierungs-prozess">Archivierungs-Prozess</h3>
<p><strong>Automatische Archivierung:</strong>
1. Logs älter als Hot-Retention werden komprimiert
2. Komprimierte Logs werden zu Warm/Cold Storage verschoben
3. Metadaten bleiben für Suche verfügbar
4. Originale werden aus Hot Storage gelöscht</p>
<p><strong>Archiv-Format:</strong>
- Kompression: gzip, bzip2
- Verschlüsselung: AES-256
- Integrität: SHA-256 Checksums
- Metadaten: JSON-Index</p>
<p><strong>Archiv-Speicherort:</strong> {{ meta.log_archive_location }}</p>
<h3 id="log-loschung">Log-Löschung</h3>
<p><strong>Automatische Löschung:</strong>
- Logs älter als Retention-Policy werden automatisch gelöscht
- Löschung wird geloggt (Audit-Trail)
- Checksums vor Löschung verifizieren</p>
<p><strong>Manuelle Löschung:</strong>
- Nur mit Management-Genehmigung
- Begründung dokumentieren
- Löschungs-Protokoll erstellen</p>
<p><strong>DSGVO-Löschung:</strong>
- Recht auf Vergessenwerden
- Personenbezogene Daten löschen
- Dokumentation der Löschung</p>
<h2 id="log-analyse-und-monitoring">Log-Analyse und -Monitoring</h2>
<h3 id="siem-integration">SIEM-Integration</h3>
<p><strong>SIEM-System:</strong> {{ meta.siem_system }}</p>
<p><strong>Funktionen:</strong>
- <strong>Real-time Monitoring:</strong> Echtzeit-Überwachung
- <strong>Correlation:</strong> Event-Korrelation
- <strong>Alerting:</strong> Automatische Alerts
- <strong>Dashboards:</strong> Visualisierung
- <strong>Reporting:</strong> Compliance-Reports
- <strong>Threat Intelligence:</strong> Integration von Threat-Feeds</p>
<h3 id="use-cases-und-correlation-rules">Use-Cases und Correlation-Rules</h3>
<h4 id="failed-login-attempts">Failed Login Attempts</h4>
<p><strong>Use-Case:</strong> Erkennung von Brute-Force-Angriffen</p>
<p><strong>Regel:</strong></p>
<div class="codehilite"><pre><span></span><code>IF failed_login_count &gt; 5 
   AND time_window = 5 minutes
   AND same_source_ip
THEN alert &quot;Possible Brute-Force Attack&quot;
</code></pre></div>

<p><strong>Severity:</strong> High<br />
<strong>Response:</strong> Account temporär sperren, IP blockieren</p>
<h4 id="privilege-escalation">Privilege Escalation</h4>
<p><strong>Use-Case:</strong> Erkennung von unautorisierten Privilegien-Änderungen</p>
<p><strong>Regel:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nx">IF</span><span class="w"> </span><span class="nx">event_type</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;privilege_change&quot;</span>
<span class="w">   </span><span class="nx">AND</span><span class="w"> </span><span class="nx">new_privilege</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;admin&quot;</span>
<span class="w">   </span><span class="nx">AND</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">NOT</span><span class="w"> </span><span class="nx">IN</span><span class="w"> </span><span class="nx">admin_group</span>
<span class="nx">THEN</span><span class="w"> </span><span class="nx">alert</span><span class="w"> </span><span class="s">&quot;Unauthorized Privilege Escalation&quot;</span>
</code></pre></div>

<p><strong>Severity:</strong> Critical<br />
<strong>Response:</strong> Sofortige Untersuchung, Account deaktivieren</p>
<h4 id="data-exfiltration">Data Exfiltration</h4>
<p><strong>Use-Case:</strong> Erkennung von ungewöhnlichen Daten-Transfers</p>
<p><strong>Regel:</strong></p>
<div class="codehilite"><pre><span></span><code>IF data_transfer_size &gt; 1GB
   AND destination = external
   AND time = outside_business_hours
THEN alert &quot;Possible Data Exfiltration&quot;
</code></pre></div>

<p><strong>Severity:</strong> Critical<br />
<strong>Response:</strong> Verbindung blockieren, Forensik starten</p>
<h4 id="malware-detection">Malware Detection</h4>
<p><strong>Use-Case:</strong> Erkennung von Malware-Aktivitäten</p>
<p><strong>Regel:</strong></p>
<div class="codehilite"><pre><span></span><code>IF antivirus_alert = &quot;malware_detected&quot;
   OR process_name IN malware_indicators
   OR network_connection TO known_c2_server
THEN alert &quot;Malware Detected&quot;
</code></pre></div>

<p><strong>Severity:</strong> Critical<br />
<strong>Response:</strong> Host isolieren, Incident-Response</p>
<h4 id="configuration-changes">Configuration Changes</h4>
<p><strong>Use-Case:</strong> Überwachung von kritischen Konfigurations-Änderungen</p>
<p><strong>Regel:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nx">IF</span><span class="w"> </span><span class="nx">event_type</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;config_change&quot;</span>
<span class="w">   </span><span class="nx">AND</span><span class="w"> </span><span class="nx">system</span><span class="w"> </span><span class="nx">IN</span><span class="w"> </span><span class="nx">critical_systems</span>
<span class="w">   </span><span class="nx">AND</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">NOT</span><span class="w"> </span><span class="nx">IN</span><span class="w"> </span><span class="nx">authorized_admins</span>
<span class="nx">THEN</span><span class="w"> </span><span class="nx">alert</span><span class="w"> </span><span class="s">&quot;Unauthorized Configuration Change&quot;</span>
</code></pre></div>

<p><strong>Severity:</strong> High<br />
<strong>Response:</strong> Change verifizieren, ggf. rollback</p>
<h3 id="dashboards">Dashboards</h3>
<h4 id="security-dashboard">Security-Dashboard</h4>
<p><strong>Metriken:</strong>
- Failed Login Attempts (letzte 24h)
- Security-Alerts (nach Severity)
- Top-10-Angreifer-IPs
- Malware-Detections
- Firewall-Blocks</p>
<p><strong>Zielgruppe:</strong> Security-Operations-Team</p>
<h4 id="operations-dashboard">Operations-Dashboard</h4>
<p><strong>Metriken:</strong>
- System-Errors (nach System)
- Application-Errors (nach App)
- Performance-Metriken
- Disk-Space-Warnungen
- Service-Verfügbarkeit</p>
<p><strong>Zielgruppe:</strong> IT-Operations-Team</p>
<h4 id="compliance-dashboard">Compliance-Dashboard</h4>
<p><strong>Metriken:</strong>
- Audit-Log-Coverage
- Retention-Compliance
- Access-Reviews
- Policy-Violations
- Privileged-Access-Monitoring</p>
<p><strong>Zielgruppe:</strong> Compliance-Officer, Auditoren</p>
<h3 id="alerting">Alerting</h3>
<p><strong>Alert-Kanäle:</strong>
- <strong>E-Mail:</strong> {{ meta.alert_email }}
- <strong>SMS:</strong> Für kritische Alerts
- <strong>Ticketing:</strong> {{ meta.ticketing_system }}
- <strong>SIEM-Console:</strong> Real-time Alerts
- <strong>Slack/Teams:</strong> Team-Benachrichtigungen</p>
<p><strong>Alert-Priorisierung:</strong></p>
<table>
<thead>
<tr>
<th>Severity</th>
<th>Response-Zeit</th>
<th>Eskalation</th>
<th>Beispiel</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Critical</strong></td>
<td>Sofort</td>
<td>Sofort an On-Call</td>
<td>Malware, Data Breach</td>
</tr>
<tr>
<td><strong>High</strong></td>
<td>&lt; 1 Stunde</td>
<td>Nach 1h</td>
<td>Failed Logins, Privilege Escalation</td>
</tr>
<tr>
<td><strong>Medium</strong></td>
<td>&lt; 4 Stunden</td>
<td>Nach 4h</td>
<td>Config Changes, Policy Violations</td>
</tr>
<tr>
<td><strong>Low</strong></td>
<td>&lt; 24 Stunden</td>
<td>Nach 24h</td>
<td>Informational Events</td>
</tr>
</tbody>
</table>
<p><strong>Alert-Tuning:</strong>
- False-Positive-Reduktion
- Threshold-Anpassung
- Whitelist für legitime Aktivitäten
- Regelmäßige Review (monatlich)</p>
<h2 id="audit-trail-anforderungen">Audit-Trail-Anforderungen</h2>
<h3 id="audit-logging-prinzipien">Audit-Logging-Prinzipien</h3>
<p><strong>Was wird geloggt:</strong>
- <strong>Wer:</strong> User-ID, IP-Adresse, Session-ID
- <strong>Was:</strong> Aktion, Ressource, Änderungen
- <strong>Wann:</strong> Timestamp (UTC)
- <strong>Wo:</strong> System, Applikation, Komponente
- <strong>Ergebnis:</strong> Erfolg/Fehler, Fehlercode</p>
<p><strong>Audit-Log-Format:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-31T10:30:45Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jdoe&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;source_ip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.100&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;file_access&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/data/sensitive/customer_data.csv&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;result&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;system&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fileserver01&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;session_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;abc123xyz&quot;</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="kritische-audit-events">Kritische Audit-Events</h3>
<h4 id="authentifizierung-und-autorisierung">Authentifizierung und Autorisierung</h4>
<p><strong>Events:</strong>
- Login (erfolgreich/fehlgeschlagen)
- Logout
- Passwort-Änderung
- Account-Erstellung/-Löschung
- Privilegien-Änderung
- Rollen-Zuweisung</p>
<h4 id="daten-zugriff">Daten-Zugriff</h4>
<p><strong>Events:</strong>
- Zugriff auf sensible Daten
- Daten-Export
- Daten-Änderung
- Daten-Löschung
- Datenbank-Queries (bei sensiblen Daten)</p>
<h4 id="system-anderungen">System-Änderungen</h4>
<p><strong>Events:</strong>
- Konfigurations-Änderungen
- Software-Installation/-Deinstallation
- Service-Start/-Stop
- Firewall-Regel-Änderungen
- Netzwerk-Änderungen</p>
<h4 id="administrative-aktivitaten">Administrative Aktivitäten</h4>
<p><strong>Events:</strong>
- Privilegierte Zugriffe
- Backup/Restore-Operationen
- Security-Policy-Änderungen
- Audit-Log-Zugriffe
- System-Wartung</p>
<h3 id="audit-log-integritat">Audit-Log-Integrität</h3>
<p><strong>Schutzmaßnahmen:</strong>
- <strong>Write-Once:</strong> Logs können nicht geändert werden
- <strong>Digitale Signaturen:</strong> Logs werden signiert
- <strong>Checksums:</strong> Integritäts-Prüfung
- <strong>Separate Storage:</strong> Logs auf separatem System
- <strong>Access-Control:</strong> Nur autorisierte Zugriffe</p>
<p><strong>Verifikation:</strong>
- Regelmäßige Integritäts-Checks
- Checksum-Validierung
- Signatur-Verifikation
- Anomalie-Erkennung (fehlende Logs)</p>
<h2 id="compliance-und-regulierung">Compliance und Regulierung</h2>
<h3 id="dsgvo-gdpr">DSGVO (GDPR)</h3>
<p><strong>Anforderungen:</strong>
- Logging von Zugriff auf personenbezogene Daten
- Recht auf Auskunft (welche Daten wurden verarbeitet)
- Recht auf Löschung (Logs mit personenbezogenen Daten)
- Meldepflicht bei Data Breach (72h)</p>
<p><strong>Umsetzung:</strong>
- Zugriffs-Logs für alle personenbezogenen Daten
- Pseudonymisierung wo möglich
- Retention-Policies beachten
- Lösch-Prozesse implementiert</p>
<h3 id="iso-27001">ISO 27001</h3>
<p><strong>Anforderungen:</strong>
- A.12.4.1: Event-Logging
- A.12.4.2: Schutz von Log-Informationen
- A.12.4.3: Administrator- und Operator-Logs
- A.12.4.4: Zeitsynchronisation</p>
<p><strong>Umsetzung:</strong>
- Umfassendes Event-Logging
- Log-Integrität sichergestellt
- Privilegierte Zugriffe geloggt
- NTP-Synchronisation</p>
<h3 id="pci-dss-falls-zutreffend">PCI-DSS (falls zutreffend)</h3>
<p><strong>Anforderungen:</strong>
- Requirement 10: Track and monitor all access to network resources and cardholder data
- Audit-Trails für alle Zugriffe
- Tägliche Log-Reviews
- Retention: Mindestens 1 Jahr (3 Monate online)</p>
<h3 id="sox-falls-zutreffend">SOX (falls zutreffend)</h3>
<p><strong>Anforderungen:</strong>
- Audit-Trails für finanzrelevante Systeme
- Änderungs-Nachvollziehbarkeit
- Access-Controls geloggt
- Retention: 7 Jahre</p>
<h2 id="log-management-tools">Log-Management-Tools</h2>
<h3 id="siem-platform">SIEM-Platform</h3>
<p><strong>System:</strong> {{ meta.siem_system }}<br />
<strong>Komponenten:</strong>
- Indexer
- Search-Heads
- Forwarders
- Deployment-Server</p>
<h3 id="log-collectors">Log-Collectors</h3>
<p><strong>Rsyslog:</strong>
- Zentrale Syslog-Server
- Filtering und Parsing
- Forwarding an SIEM</p>
<p><strong>Fluentd/Fluent Bit:</strong>
- Lightweight Log-Collector
- Plugin-basiert
- Kubernetes-Integration</p>
<p><strong>Elastic Beats:</strong>
- Filebeat: Log-Files
- Metricbeat: System-Metriken
- Packetbeat: Network-Traffic
- Auditbeat: Audit-Daten</p>
<h3 id="log-analysis-tools">Log-Analysis-Tools</h3>
<p><strong>Kibana:</strong>
- Visualisierung
- Dashboards
- Ad-hoc-Queries</p>
<p><strong>Grafana:</strong>
- Metriken-Visualisierung
- Alerting
- Multi-Source-Integration</p>
<h2 id="rollen-und-verantwortlichkeiten">Rollen und Verantwortlichkeiten</h2>
<h3 id="log-management-team">Log-Management-Team</h3>
<p><strong>Verantwortlichkeiten:</strong>
- Log-Infrastruktur-Verwaltung
- Log-Sammlung-Konfiguration
- Retention-Policy-Umsetzung
- Tool-Administration</p>
<p><strong>Team-Lead:</strong> Andreas Huemmer</p>
<h3 id="security-operations-team">Security-Operations-Team</h3>
<p><strong>Verantwortlichkeiten:</strong>
- SIEM-Monitoring
- Alert-Response
- Use-Case-Entwicklung
- Threat-Hunting</p>
<p><strong>Team-Lead:</strong> Thomas Weber</p>
<h3 id="compliance-officer">Compliance-Officer</h3>
<p><strong>Verantwortlichkeiten:</strong>
- Compliance-Anforderungen definieren
- Audit-Unterstützung
- Retention-Policy-Review
- Regulierungs-Überwachung</p>
<p><strong>Person:</strong> {{ meta.compliance_officer }}</p>
<h2 id="metriken-und-reporting">Metriken und Reporting</h2>
<h3 id="log-management-metriken">Log-Management-Metriken</h3>
<table>
<thead>
<tr>
<th>Metrik</th>
<th>Zielwert</th>
<th>Messung</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Log-Collection-Rate</strong></td>
<td>&gt; 99%</td>
<td>Gesammelte Logs / Erwartete Logs</td>
</tr>
<tr>
<td><strong>Log-Ingestion-Latency</strong></td>
<td>&lt; 5 Min</td>
<td>Zeit von Event bis SIEM</td>
</tr>
<tr>
<td><strong>Storage-Utilization</strong></td>
<td>&lt; 80%</td>
<td>Verwendeter Storage / Gesamt-Storage</td>
</tr>
<tr>
<td><strong>Alert-Response-Time</strong></td>
<td>&lt; 15 Min</td>
<td>Zeit von Alert bis Response</td>
</tr>
<tr>
<td><strong>False-Positive-Rate</strong></td>
<td>&lt; 10%</td>
<td>False Positives / Gesamt-Alerts</td>
</tr>
</tbody>
</table>
<h3 id="reporting">Reporting</h3>
<p><strong>Tägliches Log-Status-Report:</strong>
- Log-Collection-Status
- Fehlende Log-Quellen
- Storage-Auslastung
- Kritische Alerts</p>
<p><strong>Wöchentliches Security-Report:</strong>
- Security-Events-Zusammenfassung
- Top-Alerts
- Trend-Analysen
- Anomalien</p>
<p><strong>Monatliches Compliance-Report:</strong>
- Audit-Log-Coverage
- Retention-Compliance
- Access-Reviews
- Policy-Violations</p>
<p><strong>Quartalsweises Management-Report:</strong>
- Log-Management-Strategie-Review
- Kapazitäts-Planung
- Compliance-Status
- Verbesserungs-Maßnahmen</p>
<h2 id="referenzen">Referenzen</h2>
<ul>
<li>ISO/IEC 27001:2013 - A.12.4 (Logging and Monitoring)</li>
<li>NIST SP 800-92 - Guide to Computer Security Log Management</li>
<li>PCI-DSS v4.0 - Requirement 10</li>
<li>DSGVO - Artikel 30 (Verzeichnis von Verarbeitungstätigkeiten)</li>
<li>CIS Controls v8 - Control 8 (Audit Log Management)</li>
<li>ITIL v4 - Monitoring and Event Management</li>
</ul>
<hr />
<p><strong>Dokumentverantwortlicher:</strong> IT Operations Manager<br />
<strong>Genehmigt durch:</strong> CIO<br />
<strong>Version:</strong> 1.0.0<br />
<strong>Klassifizierung:</strong> internal<br />
<strong>Letzte Aktualisierung:</strong> {{ meta.date }}</p>
        </main>
        
        <nav class="page-nav">
<a href="0180_Patch_und_Update_Management.html" class="nav-prev">← Zurück</a>
<a href="index.html" class="nav-toc">Inhaltsverzeichnis</a>
<a href="0200_Kapazitaets_und_Performance_Management.html" class="nav-next">Weiter →</a>
        </nav>
        
        <footer>
            <p>Generated by Handbook Generator</p>
        </footer>
    </div>
</body>
</html>