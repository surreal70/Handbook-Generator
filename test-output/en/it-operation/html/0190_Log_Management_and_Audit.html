<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0190 - Log Management and Audit</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="template-number">0190</div>
            <h1>Log Management and Audit</h1>
        </header>
        
        <nav class="page-nav">
<a href="0180_Patch_and_Update_Management.html" class="nav-prev">← Previous</a>
<a href="index.html" class="nav-toc">Table of Contents</a>
<a href="0200_Capacity_and_Performance_Management.html" class="nav-next">Next →</a>
        </nav>
        
        <main>
<h1 id="log-management-and-audit">Log Management and Audit</h1>
<p><strong>Document-ID:</strong> [FRAMEWORK]-0190
<strong>Organisation:</strong> AdminSend GmbH
<strong>Owner:</strong> [TODO]
<strong>Approved by:</strong> [TODO]
<strong>Revision:</strong> [TODO]
<strong>Author:</strong> Handbook-Generator
<strong>Status:</strong> Draft
<strong>Classification:</strong> Internal
<strong>Last Update:</strong> [TODO]
<strong>Template Version:</strong> [TODO]</p>
<hr />
<hr />
<h2 id="purpose-and-scope">Purpose and Scope</h2>
<p>This document describes the log management and audit processes for AdminSend GmbH. It defines log collection, aggregation, retention, audit trail requirements, and SIEM integration to ensure traceability, compliance, and security monitoring.</p>
<p><strong>Scope:</strong> All IT systems, networks, applications, and security components of AdminSend GmbH</p>
<p><strong>Responsible:</strong> [TODO] ({{ meta-organisation-roles.role_CISO_email }})</p>
<h2 id="log-management-fundamentals">Log Management Fundamentals</h2>
<h3 id="objectives">Objectives</h3>
<p><strong>Primary Objectives:</strong>
- <strong>Security Monitoring:</strong> Detection of security incidents
- <strong>Compliance:</strong> Meeting regulatory requirements
- <strong>Troubleshooting:</strong> Error analysis and problem resolution
- <strong>Forensics:</strong> Traceability of events
- <strong>Audit:</strong> Evidence of controls and processes
- <strong>Performance Analysis:</strong> System and application performance</p>
<h3 id="log-types">Log Types</h3>
<h4 id="system-logs">System Logs</h4>
<p><strong>Description:</strong> Operating system events</p>
<p><strong>Examples:</strong>
- Windows Event Logs (Security, System, Application)
- Linux Syslog (/var/log/messages, /var/log/auth.log)
- Boot logs, Kernel logs</p>
<p><strong>Important Events:</strong>
- System start/stop
- Service start/stop
- Errors and warnings
- Hardware events</p>
<h4 id="security-logs">Security Logs</h4>
<p><strong>Description:</strong> Security-relevant events</p>
<p><strong>Examples:</strong>
- Authentication events (Login, Logout, Failed Login)
- Authorization events (Access denial)
- Privilege changes
- Security policy changes
- Firewall logs
- IDS/IPS alerts</p>
<p><strong>Important Events:</strong>
- Failed login attempts
- Privilege escalation
- Account changes
- Security policy changes</p>
<h4 id="application-logs">Application Logs</h4>
<p><strong>Description:</strong> Application-specific events</p>
<p><strong>Examples:</strong>
- Web server logs (Apache, Nginx, IIS)
- Database logs (MySQL, PostgreSQL, SQL Server)
- Application logs (Custom apps)
- Middleware logs (Tomcat, JBoss)</p>
<p><strong>Important Events:</strong>
- Application errors
- Transaction logs
- Performance metrics
- User activities</p>
<h4 id="network-logs">Network Logs</h4>
<p><strong>Description:</strong> Network events</p>
<p><strong>Examples:</strong>
- Firewall logs
- Router/Switch logs
- VPN logs
- DNS logs
- DHCP logs
- Proxy logs</p>
<p><strong>Important Events:</strong>
- Connection attempts (allowed/blocked)
- Network changes
- Bandwidth usage
- Anomalies</p>
<h4 id="audit-logs">Audit Logs</h4>
<p><strong>Description:</strong> Compliance and audit-relevant events</p>
<p><strong>Examples:</strong>
- Data access
- Configuration changes
- Administrative activities
- Privileged access</p>
<p><strong>Important Events:</strong>
- Who did what when?
- Changes to critical systems
- Access to sensitive data</p>
<h3 id="log-levels">Log Levels</h3>
<table>
<thead>
<tr>
<th>Level</th>
<th>Description</th>
<th>Usage</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>EMERGENCY</strong></td>
<td>System unusable</td>
<td>Critical system errors</td>
<td>Kernel Panic</td>
</tr>
<tr>
<td><strong>ALERT</strong></td>
<td>Immediate action required</td>
<td>Critical errors</td>
<td>Database unreachable</td>
</tr>
<tr>
<td><strong>CRITICAL</strong></td>
<td>Critical conditions</td>
<td>Severe errors</td>
<td>Disk full</td>
</tr>
<tr>
<td><strong>ERROR</strong></td>
<td>Error conditions</td>
<td>Errors</td>
<td>Application error</td>
</tr>
<tr>
<td><strong>WARNING</strong></td>
<td>Warning conditions</td>
<td>Warnings</td>
<td>Disk 80% full</td>
</tr>
<tr>
<td><strong>NOTICE</strong></td>
<td>Normal but significant condition</td>
<td>Important events</td>
<td>Service started</td>
</tr>
<tr>
<td><strong>INFO</strong></td>
<td>Informational messages</td>
<td>Normal events</td>
<td>User login</td>
</tr>
<tr>
<td><strong>DEBUG</strong></td>
<td>Debug messages</td>
<td>Development</td>
<td>Function calls</td>
</tr>
</tbody>
</table>
<h2 id="log-collection-and-aggregation">Log Collection and Aggregation</h2>
<h3 id="log-architecture">Log Architecture</h3>
<div class="codehilite"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                    </span><span class="n">Log</span><span class="w"> </span><span class="n">Sources</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Servers</span><span class="p">,</span><span class="w"> </span><span class="n">Network</span><span class="p">,</span><span class="w"> </span><span class="n">Applications</span><span class="p">,</span><span class="w"> </span><span class="n">Security</span><span class="w"> </span><span class="n">Devices</span><span class="w">       </span><span class="err">│</span>
<span class="err">└────────────────────┬────────────────────────────────────┘</span>
<span class="w">                     </span><span class="err">│</span>
<span class="w">                     </span><span class="err">│</span><span class="w"> </span><span class="n">Syslog</span><span class="p">,</span><span class="w"> </span><span class="n">Agents</span><span class="p">,</span><span class="w"> </span><span class="n">APIs</span>
<span class="w">                     </span><span class="err">│</span>
<span class="err">┌────────────────────▼────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">              </span><span class="n">Log</span><span class="w"> </span><span class="n">Collectors</span><span class="o">/</span><span class="n">Forwarders</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Rsyslog</span><span class="p">,</span><span class="w"> </span><span class="n">Fluentd</span><span class="p">,</span><span class="w"> </span><span class="n">Logstash</span><span class="p">,</span><span class="w"> </span><span class="n">Splunk</span><span class="w"> </span><span class="n">Forwarders</span><span class="w">         </span><span class="err">│</span>
<span class="err">└────────────────────┬────────────────────────────────────┘</span>
<span class="w">                     </span><span class="err">│</span>
<span class="w">                     </span><span class="err">│</span><span class="w"> </span><span class="n">Parsing</span><span class="p">,</span><span class="w"> </span><span class="n">Filtering</span><span class="p">,</span><span class="w"> </span><span class="n">Enrichment</span>
<span class="w">                     </span><span class="err">│</span>
<span class="err">┌────────────────────▼────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">              </span><span class="n">Log</span><span class="w"> </span><span class="n">Aggregation</span><span class="w"> </span><span class="n">Platform</span><span class="w">                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">SIEM</span><span class="p">,</span><span class="w"> </span><span class="n">ELK</span><span class="w"> </span><span class="n">Stack</span><span class="p">,</span><span class="w"> </span><span class="n">Splunk</span><span class="p">,</span><span class="w"> </span><span class="n">Graylog</span><span class="w">                       </span><span class="err">│</span>
<span class="err">└────────────────────┬────────────────────────────────────┘</span>
<span class="w">                     </span><span class="err">│</span>
<span class="w">         </span><span class="err">┌───────────┴───────────┐</span>
<span class="w">         </span><span class="err">│</span><span class="w">                       </span><span class="err">│</span>
<span class="err">┌────────▼────────┐</span><span class="w">    </span><span class="err">┌────────▼────────────────────────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">Hot</span><span class="w"> </span><span class="n">Storage</span><span class="w">     </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Cold</span><span class="w"> </span><span class="n">Storage</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Archive</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="p">(</span><span class="n">Fast</span><span class="w"> </span><span class="n">Access</span><span class="p">)</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="p">(</span><span class="n">Long</span><span class="o">-</span><span class="n">term</span><span class="w"> </span><span class="n">Retention</span><span class="p">)</span><span class="w">           </span><span class="err">│</span>
<span class="err">└─────────────────┘</span><span class="w">    </span><span class="err">└─────────────────────────────────┘</span>
</code></pre></div>

<h3 id="log-collection-methods">Log Collection Methods</h3>
<h4 id="syslog">Syslog</h4>
<p><strong>Protocol:</strong> RFC 5424 (Syslog Protocol)<br />
<strong>Transport:</strong> UDP 514 (Standard), TCP 514 (Reliable), TLS 6514 (Secure)</p>
<p><strong>Advantages:</strong>
- Standard protocol
- Widely adopted
- Simple configuration</p>
<p><strong>Disadvantages:</strong>
- UDP not reliable
- Limited structure
- No authentication (without TLS)</p>
<p><strong>Usage:</strong> Linux/Unix systems, Network devices</p>
<h4 id="agent-based">Agent-based</h4>
<p><strong>Agents:</strong>
- Splunk Universal Forwarder
- Elastic Beats (Filebeat, Metricbeat)
- Fluentd
- NXLog</p>
<p><strong>Advantages:</strong>
- Reliable transmission
- Local buffering
- Parsing and filtering
- Encrypted transmission</p>
<p><strong>Disadvantages:</strong>
- Agent installation required
- Agent management
- Resource consumption</p>
<p><strong>Usage:</strong> Servers, Workstations</p>
<h4 id="api-based">API-based</h4>
<p><strong>Methods:</strong>
- REST APIs
- Cloud provider APIs (AWS CloudWatch, Azure Monitor)
- Webhook integration</p>
<p><strong>Advantages:</strong>
- Structured data
- Real-time integration
- No agent installation</p>
<p><strong>Disadvantages:</strong>
- API limits
- Network dependency
- More complex configuration</p>
<p><strong>Usage:</strong> Cloud services, SaaS applications</p>
<h4 id="windows-event-forwarding-wef">Windows Event Forwarding (WEF)</h4>
<p><strong>Method:</strong> Windows-native event forwarding</p>
<p><strong>Advantages:</strong>
- No additional agents
- Central configuration via GPO
- Reliable</p>
<p><strong>Disadvantages:</strong>
- Windows only
- Limited parsing options</p>
<p><strong>Usage:</strong> Windows environments</p>
<h3 id="log-aggregation-platform">Log Aggregation Platform</h3>
<p><strong>SIEM System:</strong> {{ meta-handbook.siem_system }}<br />
<strong>Version:</strong> [TODO]<br />
<strong>Management URL:</strong> {{ meta-handbook.siem_url }}</p>
<p><strong>Components:</strong>
- <strong>Log Collectors:</strong> {{ meta-handbook.log_collectors }}
- <strong>Indexers:</strong> {{ meta-handbook.log_indexers }}
- <strong>Search Heads:</strong> {{ meta-handbook.log_search_heads }}
- <strong>Storage:</strong> {{ meta-handbook.log_storage }}</p>
<p><strong>Capacity:</strong>
- <strong>Ingestion Rate:</strong> {{ meta-handbook.log_ingestion_rate }} GB/day
- <strong>Storage Capacity:</strong> {{ meta-handbook.log_storage_capacity }} TB
- <strong>Retention (Hot):</strong> {{ meta-handbook.log_retention_hot }} days
- <strong>Retention (Cold):</strong> {{ meta-handbook.log_retention_cold }} days</p>
<h3 id="log-source-configuration">Log Source Configuration</h3>
<h4 id="linux-servers">Linux Servers</h4>
<p><strong>Rsyslog Configuration:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># /etc/rsyslog.d/50-remote.conf</span>

<span class="c1"># Send all logs to central syslog server</span>
*.*<span class="w"> </span>@@syslog.<span class="o">{{</span><span class="w"> </span>meta-handbook.domain<span class="w"> </span><span class="o">}}</span>:514

<span class="c1"># Send only security logs</span>
authpriv.*<span class="w"> </span>@@syslog.<span class="o">{{</span><span class="w"> </span>meta-handbook.domain<span class="w"> </span><span class="o">}}</span>:514

<span class="c1"># TLS encrypted</span>
<span class="nv">$DefaultNetstreamDriver</span><span class="w"> </span>gtls
<span class="nv">$ActionSendStreamDriverMode</span><span class="w"> </span><span class="m">1</span>
<span class="nv">$ActionSendStreamDriverAuthMode</span><span class="w"> </span>x509/name
*.*<span class="w"> </span>@@syslog.<span class="o">{{</span><span class="w"> </span>meta-handbook.domain<span class="w"> </span><span class="o">}}</span>:6514
</code></pre></div>

<h4 id="windows-servers">Windows Servers</h4>
<p><strong>Event Forwarding Configuration:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c"># Enable event forwarding</span>
<span class="n">wecutil</span> <span class="n">qc</span>

<span class="c"># Create subscription</span>
<span class="n">wecutil</span> <span class="n">cs</span> <span class="n">subscription</span><span class="p">.</span><span class="n">xml</span>

<span class="c"># Subscription XML</span>
<span class="p">&lt;</span><span class="n">Subscription</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="n">SubscriptionId</span><span class="p">&gt;</span><span class="n">Security-Events</span><span class="p">&lt;/</span><span class="n">SubscriptionId</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="n">DestinationUrl</span><span class="p">&gt;</span><span class="n">http</span><span class="p">://</span><span class="n">wec-server</span><span class="p">.{{</span> <span class="n">meta-handbook</span><span class="p">.</span><span class="n">domain</span> <span class="p">}}:</span><span class="n">5985</span><span class="p">/</span><span class="n">wsman</span><span class="p">&lt;/</span><span class="n">DestinationUrl</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="n">Query</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">QueryList</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="n">Query</span> <span class="n">Id</span><span class="p">=</span><span class="s2">&quot;0&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nb">Select </span><span class="n">Path</span><span class="p">=</span><span class="s2">&quot;Security&quot;</span><span class="p">&gt;*[</span><span class="n">System</span><span class="p">[(</span><span class="n">EventID</span><span class="p">=</span><span class="n">4624</span> <span class="n">or</span> <span class="n">EventID</span><span class="p">=</span><span class="n">4625</span><span class="p">)]]&lt;/</span><span class="n">Select</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="n">Query</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="n">QueryList</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="n">Query</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="n">Subscription</span><span class="p">&gt;</span>
</code></pre></div>

<h4 id="firewall">Firewall</h4>
<p><strong>Syslog Configuration:</strong>
- Syslog Server: [[ netbox.syslog.server ]]
- Facility: Local6
- Severity: Informational and higher
- Format: RFC 5424</p>
<p><strong>Logged Events:</strong>
- All allowed/blocked connections
- Policy changes
- VPN connections
- Admin access</p>
<h4 id="web-server-apache">Web Server (Apache)</h4>
<p><strong>Log Configuration:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c"># /etc/apache2/sites-available/default-ssl.conf</span>

<span class="c"># Access Log</span>
<span class="nb">CustomLog</span><span class="w"> </span><span class="sx">/var/log/apache2/access.log</span><span class="w"> </span>combined

<span class="c"># Error Log</span>
<span class="nb">ErrorLog</span><span class="w"> </span><span class="sx">/var/log/apache2/error.log</span>
<span class="nb">LogLevel</span><span class="w"> </span><span class="k">warn</span>

<span class="c"># Forwarding to Syslog</span>
<span class="nb">CustomLog</span><span class="w"> </span><span class="s2">&quot;|/usr/bin/logger -t apache -p local6.info&quot;</span><span class="w"> </span>combined
</code></pre></div>

<h4 id="database-mysql">Database (MySQL)</h4>
<p><strong>Log Configuration:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># /etc/mysql/my.cnf</span>

<span class="k">[mysqld]</span>
<span class="c1"># General Query Log (for debugging only)</span>
<span class="na">general_log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0</span>
<span class="na">general_log_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/log/mysql/query.log</span>

<span class="c1"># Error Log</span>
<span class="na">log_error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/log/mysql/error.log</span>

<span class="c1"># Slow Query Log</span>
<span class="na">slow_query_log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
<span class="na">slow_query_log_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/log/mysql/slow.log</span>
<span class="na">long_query_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">2</span>

<span class="c1"># Audit Plugin (for compliance)</span>
<span class="na">plugin-load</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">audit_log.so</span>
<span class="na">audit_log_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/log/mysql/audit.log</span>
<span class="na">audit_log_format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">JSON</span>
</code></pre></div>

<h2 id="log-retention-and-archiving">Log Retention and Archiving</h2>
<h3 id="retention-policies">Retention Policies</h3>
<h4 id="retention-by-log-type">Retention by Log Type</h4>
<table>
<thead>
<tr>
<th>Log Type</th>
<th>Hot Storage</th>
<th>Cold Storage</th>
<th>Total</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Security Logs</strong></td>
<td>90 days</td>
<td>7 years</td>
<td>7 years</td>
<td>Compliance, Forensics</td>
</tr>
<tr>
<td><strong>Audit Logs</strong></td>
<td>90 days</td>
<td>7 years</td>
<td>7 years</td>
<td>Compliance, Regulation</td>
</tr>
<tr>
<td><strong>System Logs</strong></td>
<td>30 days</td>
<td>1 year</td>
<td>1 year</td>
<td>Troubleshooting</td>
</tr>
<tr>
<td><strong>Application Logs</strong></td>
<td>30 days</td>
<td>1 year</td>
<td>1 year</td>
<td>Troubleshooting</td>
</tr>
<tr>
<td><strong>Network Logs</strong></td>
<td>30 days</td>
<td>1 year</td>
<td>1 year</td>
<td>Security, Troubleshooting</td>
</tr>
<tr>
<td><strong>Web Access Logs</strong></td>
<td>30 days</td>
<td>6 months</td>
<td>6 months</td>
<td>Analytics, Security</td>
</tr>
<tr>
<td><strong>Debug Logs</strong></td>
<td>7 days</td>
<td>-</td>
<td>7 days</td>
<td>Development</td>
</tr>
</tbody>
</table>
<h4 id="retention-by-compliance">Retention by Compliance</h4>
<p><strong>GDPR:</strong>
- Personal data: Only as long as necessary
- Access logs: 6 months (recommended)
- Security logs: 1-2 years</p>
<p><strong>ISO 27001:</strong>
- Security logs: At least 1 year
- Audit logs: At least 1 year</p>
<p><strong>Industry-specific:</strong>
- Financial sector: 7-10 years
- Healthcare: 10 years
- Telecommunications: 6 months (data retention)</p>
<h3 id="storage-tiers">Storage Tiers</h3>
<h4 id="hot-storage-fast-access">Hot Storage (Fast Access)</h4>
<p><strong>Technology:</strong> SSD, NVMe<br />
<strong>Retention:</strong> 30-90 days<br />
<strong>Access:</strong> Real-time search, Dashboards<br />
<strong>Cost:</strong> High</p>
<p><strong>Usage:</strong>
- Active monitoring
- Security analysis
- Troubleshooting</p>
<h4 id="warm-storage-medium-access">Warm Storage (Medium Access)</h4>
<p><strong>Technology:</strong> HDD, Object Storage<br />
<strong>Retention:</strong> 3-12 months<br />
<strong>Access:</strong> Search (slower)<br />
<strong>Cost:</strong> Medium</p>
<p><strong>Usage:</strong>
- Historical analysis
- Compliance audits
- Forensics</p>
<h4 id="cold-storage-archive">Cold Storage (Archive)</h4>
<p><strong>Technology:</strong> Tape, Cloud Glacier, Object Storage<br />
<strong>Retention:</strong> 1-7 years<br />
<strong>Access:</strong> Restore required (hours to days)<br />
<strong>Cost:</strong> Low</p>
<p><strong>Usage:</strong>
- Long-term archiving
- Compliance requirements
- Legal retention</p>
<h3 id="archiving-process">Archiving Process</h3>
<p><strong>Automatic Archiving:</strong>
1. Logs older than hot retention are compressed
2. Compressed logs are moved to warm/cold storage
3. Metadata remains available for search
4. Originals are deleted from hot storage</p>
<p><strong>Archive Format:</strong>
- Compression: gzip, bzip2
- Encryption: AES-256
- Integrity: SHA-256 checksums
- Metadata: JSON index</p>
<p><strong>Archive Location:</strong> {{ meta-handbook.log_archive_location }}</p>
<h3 id="log-deletion">Log Deletion</h3>
<p><strong>Automatic Deletion:</strong>
- Logs older than retention policy are automatically deleted
- Deletion is logged (audit trail)
- Verify checksums before deletion</p>
<p><strong>Manual Deletion:</strong>
- Only with management approval
- Document justification
- Create deletion protocol</p>
<p><strong>GDPR Deletion:</strong>
- Right to be forgotten
- Delete personal data
- Document deletion</p>
<h2 id="log-analysis-and-monitoring">Log Analysis and Monitoring</h2>
<h3 id="siem-integration">SIEM Integration</h3>
<p><strong>SIEM System:</strong> {{ meta-handbook.siem_system }}</p>
<p><strong>Functions:</strong>
- <strong>Real-time Monitoring:</strong> Real-time monitoring
- <strong>Correlation:</strong> Event correlation
- <strong>Alerting:</strong> Automatic alerts
- <strong>Dashboards:</strong> Visualization
- <strong>Reporting:</strong> Compliance reports
- <strong>Threat Intelligence:</strong> Integration of threat feeds</p>
<h3 id="use-cases-and-correlation-rules">Use Cases and Correlation Rules</h3>
<h4 id="failed-login-attempts">Failed Login Attempts</h4>
<p><strong>Use Case:</strong> Detection of brute-force attacks</p>
<p><strong>Rule:</strong></p>
<div class="codehilite"><pre><span></span><code>IF failed_login_count &gt; 5 
   AND time_window = 5 minutes
   AND same_source_ip
THEN alert &quot;Possible Brute-Force Attack&quot;
</code></pre></div>

<p><strong>Severity:</strong> High<br />
<strong>Response:</strong> Temporarily lock account, block IP</p>
<h4 id="privilege-escalation">Privilege Escalation</h4>
<p><strong>Use Case:</strong> Detection of unauthorized privilege changes</p>
<p><strong>Rule:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nx">IF</span><span class="w"> </span><span class="nx">event_type</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;privilege_change&quot;</span>
<span class="w">   </span><span class="nx">AND</span><span class="w"> </span><span class="nx">new_privilege</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;admin&quot;</span>
<span class="w">   </span><span class="nx">AND</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">NOT</span><span class="w"> </span><span class="nx">IN</span><span class="w"> </span><span class="nx">admin_group</span>
<span class="nx">THEN</span><span class="w"> </span><span class="nx">alert</span><span class="w"> </span><span class="s">&quot;Unauthorized Privilege Escalation&quot;</span>
</code></pre></div>

<p><strong>Severity:</strong> Critical<br />
<strong>Response:</strong> Immediate investigation, deactivate account</p>
<h4 id="data-exfiltration">Data Exfiltration</h4>
<p><strong>Use Case:</strong> Detection of unusual data transfers</p>
<p><strong>Rule:</strong></p>
<div class="codehilite"><pre><span></span><code>IF data_transfer_size &gt; 1GB
   AND destination = external
   AND time = outside_business_hours
THEN alert &quot;Possible Data Exfiltration&quot;
</code></pre></div>

<p><strong>Severity:</strong> Critical<br />
<strong>Response:</strong> Block connection, start forensics</p>
<h4 id="malware-detection">Malware Detection</h4>
<p><strong>Use Case:</strong> Detection of malware activities</p>
<p><strong>Rule:</strong></p>
<div class="codehilite"><pre><span></span><code>IF antivirus_alert = &quot;malware_detected&quot;
   OR process_name IN malware_indicators
   OR network_connection TO known_c2_server
THEN alert &quot;Malware Detected&quot;
</code></pre></div>

<p><strong>Severity:</strong> Critical<br />
<strong>Response:</strong> Isolate host, incident response</p>
<h4 id="configuration-changes">Configuration Changes</h4>
<p><strong>Use Case:</strong> Monitoring of critical configuration changes</p>
<p><strong>Rule:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nx">IF</span><span class="w"> </span><span class="nx">event_type</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;config_change&quot;</span>
<span class="w">   </span><span class="nx">AND</span><span class="w"> </span><span class="nx">system</span><span class="w"> </span><span class="nx">IN</span><span class="w"> </span><span class="nx">critical_systems</span>
<span class="w">   </span><span class="nx">AND</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">NOT</span><span class="w"> </span><span class="nx">IN</span><span class="w"> </span><span class="nx">authorized_admins</span>
<span class="nx">THEN</span><span class="w"> </span><span class="nx">alert</span><span class="w"> </span><span class="s">&quot;Unauthorized Configuration Change&quot;</span>
</code></pre></div>

<p><strong>Severity:</strong> High<br />
<strong>Response:</strong> Verify change, rollback if necessary</p>
<h3 id="dashboards">Dashboards</h3>
<h4 id="security-dashboard">Security Dashboard</h4>
<p><strong>Metrics:</strong>
- Failed login attempts (last 24h)
- Security alerts (by severity)
- Top 10 attacker IPs
- Malware detections
- Firewall blocks</p>
<p><strong>Target Audience:</strong> Security Operations Team</p>
<h4 id="operations-dashboard">Operations Dashboard</h4>
<p><strong>Metrics:</strong>
- System errors (by system)
- Application errors (by app)
- Performance metrics
- Disk space warnings
- Service availability</p>
<p><strong>Target Audience:</strong> IT Operations Team</p>
<h4 id="compliance-dashboard">Compliance Dashboard</h4>
<p><strong>Metrics:</strong>
- Audit log coverage
- Retention compliance
- Access reviews
- Policy violations
- Privileged access monitoring</p>
<p><strong>Target Audience:</strong> Compliance Officer, Auditors</p>
<h3 id="alerting">Alerting</h3>
<p><strong>Alert Channels:</strong>
- <strong>Email:</strong> {{ meta-handbook.alert_email }}
- <strong>SMS:</strong> For critical alerts
- <strong>Ticketing:</strong> {{ meta-handbook.ticketing_system }}
- <strong>SIEM Console:</strong> Real-time alerts
- <strong>Slack/Teams:</strong> Team notifications</p>
<p><strong>Alert Prioritization:</strong></p>
<table>
<thead>
<tr>
<th>Severity</th>
<th>Response Time</th>
<th>Escalation</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Critical</strong></td>
<td>Immediate</td>
<td>Immediate to on-call</td>
<td>Malware, Data Breach</td>
</tr>
<tr>
<td><strong>High</strong></td>
<td>&lt; 1 hour</td>
<td>After 1h</td>
<td>Failed Logins, Privilege Escalation</td>
</tr>
<tr>
<td><strong>Medium</strong></td>
<td>&lt; 4 hours</td>
<td>After 4h</td>
<td>Config Changes, Policy Violations</td>
</tr>
<tr>
<td><strong>Low</strong></td>
<td>&lt; 24 hours</td>
<td>After 24h</td>
<td>Informational Events</td>
</tr>
</tbody>
</table>
<p><strong>Alert Tuning:</strong>
- False positive reduction
- Threshold adjustment
- Whitelist for legitimate activities
- Regular review (monthly)</p>
<h2 id="audit-trail-requirements">Audit Trail Requirements</h2>
<h3 id="audit-logging-principles">Audit Logging Principles</h3>
<p><strong>What is logged:</strong>
- <strong>Who:</strong> User ID, IP address, Session ID
- <strong>What:</strong> Action, Resource, Changes
- <strong>When:</strong> Timestamp (UTC)
- <strong>Where:</strong> System, Application, Component
- <strong>Result:</strong> Success/Failure, Error code</p>
<p><strong>Audit Log Format:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-31T10:30:45Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jdoe&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;source_ip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.100&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;file_access&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;resource&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/data/sensitive/customer_data.csv&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;result&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;system&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fileserver01&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;session_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;abc123xyz&quot;</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="critical-audit-events">Critical Audit Events</h3>
<h4 id="authentication-and-authorization">Authentication and Authorization</h4>
<p><strong>Events:</strong>
- Login (successful/failed)
- Logout
- Password change
- Account creation/deletion
- Privilege change
- Role assignment</p>
<h4 id="data-access">Data Access</h4>
<p><strong>Events:</strong>
- Access to sensitive data
- Data export
- Data modification
- Data deletion
- Database queries (for sensitive data)</p>
<h4 id="system-changes">System Changes</h4>
<p><strong>Events:</strong>
- Configuration changes
- Software installation/uninstallation
- Service start/stop
- Firewall rule changes
- Network changes</p>
<h4 id="administrative-activities">Administrative Activities</h4>
<p><strong>Events:</strong>
- Privileged access
- Backup/restore operations
- Security policy changes
- Audit log access
- System maintenance</p>
<h3 id="audit-log-integrity">Audit Log Integrity</h3>
<p><strong>Protection Measures:</strong>
- <strong>Write-Once:</strong> Logs cannot be modified
- <strong>Digital Signatures:</strong> Logs are signed
- <strong>Checksums:</strong> Integrity verification
- <strong>Separate Storage:</strong> Logs on separate system
- <strong>Access Control:</strong> Only authorized access</p>
<p><strong>Verification:</strong>
- Regular integrity checks
- Checksum validation
- Signature verification
- Anomaly detection (missing logs)</p>
<h2 id="roles-and-responsibilities">Roles and Responsibilities</h2>
<h3 id="log-management-team">Log Management Team</h3>
<p><strong>Responsibilities:</strong>
- Log infrastructure management
- Log collection configuration
- Retention policy implementation
- Tool administration</p>
<p><strong>Team Lead:</strong> {{ meta-organisation-roles.role_IT_Operations_Manager }}</p>
<h3 id="security-operations-team">Security Operations Team</h3>
<p><strong>Responsibilities:</strong>
- SIEM monitoring
- Alert response
- Use case development
- Threat hunting</p>
<p><strong>Team Lead:</strong> [TODO]</p>
<h3 id="compliance-officer">Compliance Officer</h3>
<p><strong>Responsibilities:</strong>
- Define compliance requirements
- Audit support
- Retention policy review
- Regulatory monitoring</p>
<p><strong>Person:</strong> [TODO]</p>
<h2 id="compliance-and-regulation">Compliance and Regulation</h2>
<h3 id="gdpr">GDPR</h3>
<p><strong>Requirements:</strong>
- Logging of access to personal data
- Right to information (which data was processed)
- Right to deletion (logs with personal data)
- Breach notification obligation (72h)</p>
<p><strong>Implementation:</strong>
- Access logs for all personal data
- Pseudonymization where possible
- Observe retention policies
- Deletion processes implemented</p>
<h3 id="iso-27001">ISO 27001</h3>
<p><strong>Requirements:</strong>
- A.12.4.1: Event Logging
- A.12.4.2: Protection of log information
- A.12.4.3: Administrator and operator logs
- A.12.4.4: Time synchronization</p>
<p><strong>Implementation:</strong>
- Comprehensive event logging
- Log integrity ensured
- Privileged access logged
- NTP synchronization</p>
<h3 id="pci-dss-if-applicable">PCI-DSS (if applicable)</h3>
<p><strong>Requirements:</strong>
- Requirement 10: Track and monitor all access to network resources and cardholder data
- Audit trails for all access
- Daily log reviews
- Retention: At least 1 year (3 months online)</p>
<h3 id="sox-if-applicable">SOX (if applicable)</h3>
<p><strong>Requirements:</strong>
- Audit trails for financially relevant systems
- Change traceability
- Access controls logged
- Retention: 7 years</p>
<h2 id="log-management-tools">Log Management Tools</h2>
<h3 id="siem-platform">SIEM Platform</h3>
<p><strong>System:</strong> {{ meta-handbook.siem_system }}<br />
<strong>Components:</strong>
- Indexers
- Search Heads
- Forwarders
- Deployment Server</p>
<h3 id="log-collectors">Log Collectors</h3>
<p><strong>Rsyslog:</strong>
- Central syslog servers
- Filtering and parsing
- Forwarding to SIEM</p>
<p><strong>Fluentd/Fluent Bit:</strong>
- Lightweight log collector
- Plugin-based
- Kubernetes integration</p>
<p><strong>Elastic Beats:</strong>
- Filebeat: Log files
- Metricbeat: System metrics
- Packetbeat: Network traffic
- Auditbeat: Audit data</p>
<h3 id="log-analysis-tools">Log Analysis Tools</h3>
<p><strong>Kibana:</strong>
- Visualization
- Dashboards
- Ad-hoc queries</p>
<p><strong>Grafana:</strong>
- Metrics visualization
- Alerting
- Multi-source integration</p>
<h2 id="metrics-and-reporting">Metrics and Reporting</h2>
<h3 id="log-management-metrics">Log Management Metrics</h3>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Target Value</th>
<th>Measurement</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Log Collection Rate</strong></td>
<td>&gt; 99%</td>
<td>Collected Logs / Expected Logs</td>
</tr>
<tr>
<td><strong>Log Ingestion Latency</strong></td>
<td>&lt; 5 Min</td>
<td>Time from Event to SIEM</td>
</tr>
<tr>
<td><strong>Storage Utilization</strong></td>
<td>&lt; 80%</td>
<td>Used Storage / Total Storage</td>
</tr>
<tr>
<td><strong>Alert Response Time</strong></td>
<td>&lt; 15 Min</td>
<td>Time from Alert to Response</td>
</tr>
<tr>
<td><strong>False Positive Rate</strong></td>
<td>&lt; 10%</td>
<td>False Positives / Total Alerts</td>
</tr>
</tbody>
</table>
<h3 id="reporting">Reporting</h3>
<p><strong>Daily Log Status Report:</strong>
- Log collection status
- Missing log sources
- Storage utilization
- Critical alerts</p>
<p><strong>Weekly Security Report:</strong>
- Security events summary
- Top alerts
- Trend analysis
- Anomalies</p>
<p><strong>Monthly Compliance Report:</strong>
- Audit log coverage
- Retention compliance
- Access reviews
- Policy violations</p>
<p><strong>Quarterly Management Report:</strong>
- Log management strategy review
- Capacity planning
- Compliance status
- Improvement measures</p>
<h2 id="references">References</h2>
<ul>
<li>ISO/IEC 27001:2013 - A.12.4 (Logging and Monitoring)</li>
<li>NIST SP 800-92 - Guide to Computer Security Log Management</li>
<li>PCI-DSS v4.0 - Requirement 10</li>
<li>GDPR - Article 30 (Record of processing activities)</li>
<li>CIS Controls v8 - Control 8 (Audit Log Management)</li>
<li>ITIL v4 - Monitoring and Event Management</li>
</ul>
<p><strong>Document Owner:</strong> [TODO]<br />
<strong>Approved by:</strong> [TODO]<br />
<strong>Version:</strong> 0<br />
<strong>Classification:</strong> Internal<br />
<strong>Last Update:</strong> {{ meta-handbook.date }}</p>
        </main>
        
        <nav class="page-nav">
<a href="0180_Patch_and_Update_Management.html" class="nav-prev">← Previous</a>
<a href="index.html" class="nav-toc">Table of Contents</a>
<a href="0200_Capacity_and_Performance_Management.html" class="nav-next">Next →</a>
        </nav>
        
        <footer>
            <p>Generated by Handbook Generator</p>
        </footer>
    </div>
</body>
</html>