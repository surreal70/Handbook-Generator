<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0190 - Log Management and Audit</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="template-number">0190</div>
            <h1>Log Management and Audit</h1>
        </header>
        
        <nav class="page-nav">
<a href="0180_Patch_and_Update_Management.html" class="nav-prev">← Previous</a>
<a href="index.html" class="nav-toc">Table of Contents</a>
<a href="0200_Capacity_and_Performance_Management.html" class="nav-next">Next →</a>
        </nav>
        
        <main>
<h1 id="log-management-and-audit">Log Management and Audit</h1>
<h2 id="purpose-and-scope">Purpose and Scope</h2>
<p>This document describes the log management and audit processes for AdminSend GmbH. It defines log collection, aggregation, retention, audit trail requirements, and SIEM integration to ensure traceability, compliance, and security monitoring.</p>
<p><strong>Scope:</strong> All IT systems, networks, applications, and security components of AdminSend GmbH</p>
<p><strong>Responsible:</strong> Thomas Weber (thomas.weber@adminsend.de)</p>
<h2 id="log-management-fundamentals">Log Management Fundamentals</h2>
<h3 id="objectives">Objectives</h3>
<p><strong>Primary Objectives:</strong>
- <strong>Security Monitoring:</strong> Detection of security incidents
- <strong>Compliance:</strong> Meeting regulatory requirements
- <strong>Troubleshooting:</strong> Error analysis and problem resolution
- <strong>Forensics:</strong> Traceability of events
- <strong>Audit:</strong> Evidence of controls and processes
- <strong>Performance Analysis:</strong> System and application performance</p>
<h3 id="log-types">Log Types</h3>
<h4 id="system-logs">System Logs</h4>
<p><strong>Description:</strong> Operating system events</p>
<p><strong>Examples:</strong>
- Windows Event Logs (Security, System, Application)
- Linux Syslog (/var/log/messages, /var/log/auth.log)
- Boot logs, Kernel logs</p>
<p><strong>Important Events:</strong>
- System start/stop
- Service start/stop
- Errors and warnings
- Hardware events</p>
<h4 id="security-logs">Security Logs</h4>
<p><strong>Description:</strong> Security-relevant events</p>
<p><strong>Examples:</strong>
- Authentication events (Login, Logout, Failed Login)
- Authorization events (Access denial)
- Privilege changes
- Security policy changes
- Firewall logs
- IDS/IPS alerts</p>
<p><strong>Important Events:</strong>
- Failed login attempts
- Privilege escalation
- Account changes
- Security policy changes</p>
<h4 id="application-logs">Application Logs</h4>
<p><strong>Description:</strong> Application-specific events</p>
<p><strong>Examples:</strong>
- Web server logs (Apache, Nginx, IIS)
- Database logs (MySQL, PostgreSQL, SQL Server)
- Application logs (Custom apps)
- Middleware logs (Tomcat, JBoss)</p>
<p><strong>Important Events:</strong>
- Application errors
- Transaction logs
- Performance metrics
- User activities</p>
<h4 id="network-logs">Network Logs</h4>
<p><strong>Description:</strong> Network events</p>
<p><strong>Examples:</strong>
- Firewall logs
- Router/Switch logs
- VPN logs
- DNS logs
- DHCP logs
- Proxy logs</p>
<p><strong>Important Events:</strong>
- Connection attempts (allowed/blocked)
- Network changes
- Bandwidth usage
- Anomalies</p>
<h4 id="audit-logs">Audit Logs</h4>
<p><strong>Description:</strong> Compliance and audit-relevant events</p>
<p><strong>Examples:</strong>
- Data access
- Configuration changes
- Administrative activities
- Privileged access</p>
<p><strong>Important Events:</strong>
- Who did what when?
- Changes to critical systems
- Access to sensitive data</p>
<h3 id="log-levels">Log Levels</h3>
<table>
<thead>
<tr>
<th>Level</th>
<th>Description</th>
<th>Usage</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>EMERGENCY</strong></td>
<td>System unusable</td>
<td>Critical system errors</td>
<td>Kernel Panic</td>
</tr>
<tr>
<td><strong>ALERT</strong></td>
<td>Immediate action required</td>
<td>Critical errors</td>
<td>Database unreachable</td>
</tr>
<tr>
<td><strong>CRITICAL</strong></td>
<td>Critical conditions</td>
<td>Severe errors</td>
<td>Disk full</td>
</tr>
<tr>
<td><strong>ERROR</strong></td>
<td>Error conditions</td>
<td>Errors</td>
<td>Application error</td>
</tr>
<tr>
<td><strong>WARNING</strong></td>
<td>Warning conditions</td>
<td>Warnings</td>
<td>Disk 80% full</td>
</tr>
<tr>
<td><strong>NOTICE</strong></td>
<td>Normal but significant condition</td>
<td>Important events</td>
<td>Service started</td>
</tr>
<tr>
<td><strong>INFO</strong></td>
<td>Informational messages</td>
<td>Normal events</td>
<td>User login</td>
</tr>
<tr>
<td><strong>DEBUG</strong></td>
<td>Debug messages</td>
<td>Development</td>
<td>Function calls</td>
</tr>
</tbody>
</table>
<h2 id="log-collection-and-aggregation">Log Collection and Aggregation</h2>
<h3 id="log-architecture">Log Architecture</h3>
<div class="codehilite"><pre><span></span><code><span class="err">┌─────────────────────────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">                    </span><span class="n">Log</span><span class="w"> </span><span class="n">Sources</span><span class="w">                          </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Servers</span><span class="p">,</span><span class="w"> </span><span class="n">Network</span><span class="p">,</span><span class="w"> </span><span class="n">Applications</span><span class="p">,</span><span class="w"> </span><span class="n">Security</span><span class="w"> </span><span class="n">Devices</span><span class="w">       </span><span class="err">│</span>
<span class="err">└────────────────────┬────────────────────────────────────┘</span>
<span class="w">                     </span><span class="err">│</span>
<span class="w">                     </span><span class="err">│</span><span class="w"> </span><span class="n">Syslog</span><span class="p">,</span><span class="w"> </span><span class="n">Agents</span><span class="p">,</span><span class="w"> </span><span class="n">APIs</span>
<span class="w">                     </span><span class="err">│</span>
<span class="err">┌────────────────────▼────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">              </span><span class="n">Log</span><span class="w"> </span><span class="n">Collectors</span><span class="o">/</span><span class="n">Forwarders</span><span class="w">                   </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">Rsyslog</span><span class="p">,</span><span class="w"> </span><span class="n">Fluentd</span><span class="p">,</span><span class="w"> </span><span class="n">Logstash</span><span class="p">,</span><span class="w"> </span><span class="n">Splunk</span><span class="w"> </span><span class="n">Forwarders</span><span class="w">         </span><span class="err">│</span>
<span class="err">└────────────────────┬────────────────────────────────────┘</span>
<span class="w">                     </span><span class="err">│</span>
<span class="w">                     </span><span class="err">│</span><span class="w"> </span><span class="n">Parsing</span><span class="p">,</span><span class="w"> </span><span class="n">Filtering</span><span class="p">,</span><span class="w"> </span><span class="n">Enrichment</span>
<span class="w">                     </span><span class="err">│</span>
<span class="err">┌────────────────────▼────────────────────────────────────┐</span>
<span class="err">│</span><span class="w">              </span><span class="n">Log</span><span class="w"> </span><span class="n">Aggregation</span><span class="w"> </span><span class="n">Platform</span><span class="w">                    </span><span class="err">│</span>
<span class="err">│</span><span class="w">  </span><span class="n">SIEM</span><span class="p">,</span><span class="w"> </span><span class="n">ELK</span><span class="w"> </span><span class="n">Stack</span><span class="p">,</span><span class="w"> </span><span class="n">Splunk</span><span class="p">,</span><span class="w"> </span><span class="n">Graylog</span><span class="w">                       </span><span class="err">│</span>
<span class="err">└────────────────────┬────────────────────────────────────┘</span>
<span class="w">                     </span><span class="err">│</span>
<span class="w">         </span><span class="err">┌───────────┴───────────┐</span>
<span class="w">         </span><span class="err">│</span><span class="w">                       </span><span class="err">│</span>
<span class="err">┌────────▼────────┐</span><span class="w">    </span><span class="err">┌────────▼────────────────────────┐</span>
<span class="err">│</span><span class="w"> </span><span class="n">Hot</span><span class="w"> </span><span class="n">Storage</span><span class="w">     </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">Cold</span><span class="w"> </span><span class="n">Storage</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Archive</span><span class="w">          </span><span class="err">│</span>
<span class="err">│</span><span class="w"> </span><span class="p">(</span><span class="n">Fast</span><span class="w"> </span><span class="n">Access</span><span class="p">)</span><span class="w">   </span><span class="err">│</span><span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="p">(</span><span class="n">Long</span><span class="o">-</span><span class="n">term</span><span class="w"> </span><span class="n">Retention</span><span class="p">)</span><span class="w">           </span><span class="err">│</span>
<span class="err">└─────────────────┘</span><span class="w">    </span><span class="err">└─────────────────────────────────┘</span>
</code></pre></div>

<h3 id="log-collection-methods">Log Collection Methods</h3>
<h4 id="syslog">Syslog</h4>
<p><strong>Protocol:</strong> RFC 5424 (Syslog Protocol)<br />
<strong>Transport:</strong> UDP 514 (Standard), TCP 514 (Reliable), TLS 6514 (Secure)</p>
<p><strong>Advantages:</strong>
- Standard protocol
- Widely adopted
- Simple configuration</p>
<p><strong>Disadvantages:</strong>
- UDP not reliable
- Limited structure
- No authentication (without TLS)</p>
<p><strong>Usage:</strong> Linux/Unix systems, Network devices</p>
<h4 id="agent-based">Agent-based</h4>
<p><strong>Agents:</strong>
- Splunk Universal Forwarder
- Elastic Beats (Filebeat, Metricbeat)
- Fluentd
- NXLog</p>
<p><strong>Advantages:</strong>
- Reliable transmission
- Local buffering
- Parsing and filtering
- Encrypted transmission</p>
<p><strong>Disadvantages:</strong>
- Agent installation required
- Agent management
- Resource consumption</p>
<p><strong>Usage:</strong> Servers, Workstations</p>
<h4 id="api-based">API-based</h4>
<p><strong>Methods:</strong>
- REST APIs
- Cloud provider APIs (AWS CloudWatch, Azure Monitor)
- Webhook integration</p>
<p><strong>Advantages:</strong>
- Structured data
- Real-time integration
- No agent installation</p>
<p><strong>Disadvantages:</strong>
- API limits
- Network dependency
- More complex configuration</p>
<p><strong>Usage:</strong> Cloud services, SaaS applications</p>
<h4 id="windows-event-forwarding-wef">Windows Event Forwarding (WEF)</h4>
<p><strong>Method:</strong> Windows-native event forwarding</p>
<p><strong>Advantages:</strong>
- No additional agents
- Central configuration via GPO
- Reliable</p>
<p><strong>Disadvantages:</strong>
- Windows only
- Limited parsing options</p>
<p><strong>Usage:</strong> Windows environments</p>
<h3 id="log-aggregation-platform">Log Aggregation Platform</h3>
<p><strong>SIEM System:</strong> {{ meta.siem_system }}<br />
<strong>Version:</strong> {{ meta.siem_version }}<br />
<strong>Management URL:</strong> {{ meta.siem_url }}</p>
<p><strong>Components:</strong>
- <strong>Log Collectors:</strong> {{ meta.log_collectors }}
- <strong>Indexers:</strong> {{ meta.log_indexers }}
- <strong>Search Heads:</strong> {{ meta.log_search_heads }}
- <strong>Storage:</strong> {{ meta.log_storage }}</p>
<p><strong>Capacity:</strong>
- <strong>Ingestion Rate:</strong> {{ meta.log_ingestion_rate }} GB/day
- <strong>Storage Capacity:</strong> {{ meta.log_storage_capacity }} TB
- <strong>Retention (Hot):</strong> {{ meta.log_retention_hot }} days
- <strong>Retention (Cold):</strong> {{ meta.log_retention_cold }} days</p>
<h2 id="log-retention-and-archiving">Log Retention and Archiving</h2>
<h3 id="retention-policies">Retention Policies</h3>
<h4 id="retention-by-log-type">Retention by Log Type</h4>
<table>
<thead>
<tr>
<th>Log Type</th>
<th>Hot Storage</th>
<th>Cold Storage</th>
<th>Total</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Security Logs</strong></td>
<td>90 days</td>
<td>7 years</td>
<td>7 years</td>
<td>Compliance, Forensics</td>
</tr>
<tr>
<td><strong>Audit Logs</strong></td>
<td>90 days</td>
<td>7 years</td>
<td>7 years</td>
<td>Compliance, Regulation</td>
</tr>
<tr>
<td><strong>System Logs</strong></td>
<td>30 days</td>
<td>1 year</td>
<td>1 year</td>
<td>Troubleshooting</td>
</tr>
<tr>
<td><strong>Application Logs</strong></td>
<td>30 days</td>
<td>1 year</td>
<td>1 year</td>
<td>Troubleshooting</td>
</tr>
<tr>
<td><strong>Network Logs</strong></td>
<td>30 days</td>
<td>1 year</td>
<td>1 year</td>
<td>Security, Troubleshooting</td>
</tr>
<tr>
<td><strong>Web Access Logs</strong></td>
<td>30 days</td>
<td>6 months</td>
<td>6 months</td>
<td>Analytics, Security</td>
</tr>
<tr>
<td><strong>Debug Logs</strong></td>
<td>7 days</td>
<td>-</td>
<td>7 days</td>
<td>Development</td>
</tr>
</tbody>
</table>
<h3 id="storage-tiers">Storage Tiers</h3>
<h4 id="hot-storage-fast-access">Hot Storage (Fast Access)</h4>
<p><strong>Technology:</strong> SSD, NVMe<br />
<strong>Retention:</strong> 30-90 days<br />
<strong>Access:</strong> Real-time search, Dashboards<br />
<strong>Cost:</strong> High</p>
<p><strong>Usage:</strong>
- Active monitoring
- Security analysis
- Troubleshooting</p>
<h4 id="warm-storage-medium-access">Warm Storage (Medium Access)</h4>
<p><strong>Technology:</strong> HDD, Object Storage<br />
<strong>Retention:</strong> 3-12 months<br />
<strong>Access:</strong> Search (slower)<br />
<strong>Cost:</strong> Medium</p>
<p><strong>Usage:</strong>
- Historical analysis
- Compliance audits
- Forensics</p>
<h4 id="cold-storage-archive">Cold Storage (Archive)</h4>
<p><strong>Technology:</strong> Tape, Cloud Glacier, Object Storage<br />
<strong>Retention:</strong> 1-7 years<br />
<strong>Access:</strong> Restore required (hours to days)<br />
<strong>Cost:</strong> Low</p>
<p><strong>Usage:</strong>
- Long-term archiving
- Compliance requirements
- Legal retention</p>
<h2 id="log-analysis-and-monitoring">Log Analysis and Monitoring</h2>
<h3 id="siem-integration">SIEM Integration</h3>
<p><strong>SIEM System:</strong> {{ meta.siem_system }}</p>
<p><strong>Functions:</strong>
- <strong>Real-time Monitoring:</strong> Real-time monitoring
- <strong>Correlation:</strong> Event correlation
- <strong>Alerting:</strong> Automatic alerts
- <strong>Dashboards:</strong> Visualization
- <strong>Reporting:</strong> Compliance reports
- <strong>Threat Intelligence:</strong> Integration of threat feeds</p>
<h3 id="use-cases-and-correlation-rules">Use Cases and Correlation Rules</h3>
<h4 id="failed-login-attempts">Failed Login Attempts</h4>
<p><strong>Use Case:</strong> Detection of brute-force attacks</p>
<p><strong>Rule:</strong></p>
<div class="codehilite"><pre><span></span><code>IF failed_login_count &gt; 5 
   AND time_window = 5 minutes
   AND same_source_ip
THEN alert &quot;Possible Brute-Force Attack&quot;
</code></pre></div>

<p><strong>Severity:</strong> High<br />
<strong>Response:</strong> Temporarily lock account, block IP</p>
<h4 id="privilege-escalation">Privilege Escalation</h4>
<p><strong>Use Case:</strong> Detection of unauthorized privilege changes</p>
<p><strong>Rule:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nx">IF</span><span class="w"> </span><span class="nx">event_type</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;privilege_change&quot;</span>
<span class="w">   </span><span class="nx">AND</span><span class="w"> </span><span class="nx">new_privilege</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;admin&quot;</span>
<span class="w">   </span><span class="nx">AND</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">NOT</span><span class="w"> </span><span class="nx">IN</span><span class="w"> </span><span class="nx">admin_group</span>
<span class="nx">THEN</span><span class="w"> </span><span class="nx">alert</span><span class="w"> </span><span class="s">&quot;Unauthorized Privilege Escalation&quot;</span>
</code></pre></div>

<p><strong>Severity:</strong> Critical<br />
<strong>Response:</strong> Immediate investigation, deactivate account</p>
<h2 id="compliance-and-regulation">Compliance and Regulation</h2>
<h3 id="gdpr">GDPR</h3>
<p><strong>Requirements:</strong>
- Logging of access to personal data
- Right to information (which data was processed)
- Right to deletion (logs with personal data)
- Breach notification obligation (72h)</p>
<p><strong>Implementation:</strong>
- Access logs for all personal data
- Pseudonymization where possible
- Observe retention policies
- Deletion processes implemented</p>
<h3 id="iso-27001">ISO 27001</h3>
<p><strong>Requirements:</strong>
- A.12.4.1: Event Logging
- A.12.4.2: Protection of log information
- A.12.4.3: Administrator and operator logs
- A.12.4.4: Time synchronization</p>
<p><strong>Implementation:</strong>
- Comprehensive event logging
- Log integrity ensured
- Privileged access logged
- NTP synchronization</p>
<h2 id="references">References</h2>
<ul>
<li>ISO/IEC 27001:2013 - A.12.4 (Logging and Monitoring)</li>
<li>NIST SP 800-92 - Guide to Computer Security Log Management</li>
<li>PCI-DSS v4.0 - Requirement 10</li>
<li>GDPR - Article 30 (Record of processing activities)</li>
<li>CIS Controls v8 - Control 8 (Audit Log Management)</li>
<li>ITIL v4 - Monitoring and Event Management</li>
</ul>
<hr />
<p><strong>Document Owner:</strong> IT Operations Manager<br />
<strong>Approved by:</strong> CIO<br />
<strong>Version:</strong> 1.0.0<br />
<strong>Classification:</strong> internal<br />
<strong>Last Update:</strong> {{ meta.date }}</p>
        </main>
        
        <nav class="page-nav">
<a href="0180_Patch_and_Update_Management.html" class="nav-prev">← Previous</a>
<a href="index.html" class="nav-toc">Table of Contents</a>
<a href="0200_Capacity_and_Performance_Management.html" class="nav-next">Next →</a>
        </nav>
        
        <footer>
            <p>Generated by Handbook Generator</p>
        </footer>
    </div>
</body>
</html>